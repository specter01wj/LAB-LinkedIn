/*
 jCanvas v13.01.14
 Copyright 2013 Caleb Evans
 Released under the MIT license
*/
(function(d,Y,ca,Q,da,u,v,g,w){function E(){}function H(c){c?B(ea,c):H.prefs=ea=E.prototype=B({},V);return this}function C(c){return c&&c.getContext?c.getContext("2d"):g}function K(c,a){c.fillStyle=a.fillStyle;c.strokeStyle=a.strokeStyle;c.lineWidth=a.strokeWidth;a.rounded?(c.lineCap="round",c.lineJoin="round"):(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=
a.opacity;c.globalCompositeOperation=a.compositing}function N(c,a,b){b.closed&&a.closePath();a.fill();"transparent"!==b.fillStyle&&(a.shadowColor="transparent");0!==b.strokeWidth&&a.stroke();b.closed||a.closePath();b._transformed&&a.restore();b.mask&&(b.autosave&&(a.save(),c=L(c),c.transforms.mask=u,c.savedTransforms=B({},c.transforms)),a.clip())}function fa(c,a,b){a._toRad=a.inDegrees?F/180:1;c.translate(a.x,a.y);c.rotate(a.rotate*a._toRad);c.translate(-a.x,-a.y);b.rotate+=a.rotate*a._toRad}function ga(c,
a,b){1!==a.scale&&(a.scaleX=a.scaleY=a.scale);c.translate(a.x,a.y);c.scale(a.scaleX,a.scaleY);c.translate(-a.x,-a.y);b.scaleX*=a.scaleX;b.scaleY*=a.scaleY}function ha(c,a,b){a.translate&&(a.translateX=a.translateY=a.translate);c.translate(a.translateX,a.translateY);b.translateX+=a.translateX;b.translateY+=a.translateY}function J(c,a,b,e){a._toRad=a.inDegrees?F/180:1;a._transformed=u;c.save();e===w&&(e=b);!a.fromCenter&&!a._centered&&(a.x+=b/2,a.y+=e/2,a._centered=u);a.rotate&&fa(c,a,{});(1!==a.scale||
1!==a.scaleX||1!==a.scaleY)&&ga(c,a,{});(a.translate||a.translateX||a.translateY)&&ha(c,a,{})}function L(c){var a;G.canvas===c?a=G.data:(a=d.data(c,"jCanvas"),a||(a={layers:[],intersects:[],drag:{},event:{},transforms:{rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,mask:v},animating:v,animated:g},a.savedTransforms=B({},a.transforms),d.data(c,"jCanvas",a)),G.canvas=c,G.data=a);return a}function ia(c,a,b){b&&b.visible&&(b.method===d.fn.draw?b.fn.call(c[0],a):b.method&&b.method.call(c,b))}function I(c,
a,b,e){var f,j,D="function"===typeof b,t;b=b||{};a._args=b;if(a.layer&&!a._layer){f=d(c);a=f.getLayers();D&&(b={method:d.fn.draw,fn:b});b=B(new E,b);if(!D){b.method=d.fn[b.method]||e;t=L(c);for(j in H.events)H.events.hasOwnProperty(j)&&b[j]&&(j=Z(j),H.events[j](f,t),b._event=u);if(b.draggable||b.cursor){b._event=u;c=["mousedown","mousemove","mouseup"];for(e=0;e<c.length;e+=1)j=Z(c[e]),H.events[j](f,t);t.mouseout||(f.bind("mouseout.jCanvas",function(){t.drag={};f.drawLayers()}),t.mouseout=u)}}b.layer=
u;b._layer=u;b.index===w&&(b.index=a.length);a.splice(b.index,0,b)}return b}function ja(c){var a;for(a=0;a<P.length;a+=1)c[P[a]]=c["_"+P[a]]}function ka(c,a){var b;for(b=0;b<P.length;b+=1)c["_"+P[b]]=c[P[b]],$[P[b]]=1,a&&delete c[P[b]]}function la(c){var a,b,e=[],f=1;c.match(/^#?\w+$/i)&&("transparent"===c&&(c="rgba(0,0,0,0)"),b=Y.head,a=b.style.color,b.style.color=c,c=d.css(b,"color"),b.style.color=a);c.match(/^rgb/i)&&(e=c.match(/\d+/gi),c.match(/%/gi)&&(f=2.55),e[0]*=f,e[1]*=f,e[2]*=f,e[3]=e[3]!==
w?da(e[3]):1);return e}function qa(c){var a=3,b;"object"!==typeof c.start&&(c.start=la(c.start),c.end=la(c.end));c.now=[];if(1!==c.start[3]||1!==c.end[3])a=4;for(b=0;b<a;b+=1)c.now[b]=c.start[b]+(c.end[b]-c.start[b])*c.pos,3>b&&(c.now[b]=S(c.now[b]));1!==c.start[3]||1!==c.end[3]?c.now="rgba("+c.now.join(",")+")":(c.now.slice(0,3),c.now="rgb("+c.now.join(",")+")");c.elem.nodeName?c.elem.style[c.prop]=c.now:c.elem[c.prop]=c.now}function Z(c){"ontouchstart"in window&&aa[c]&&(c=aa[c]);return c}function O(c){H.events[c]=
function(a,b){c=Z(c);var e="mouseover"===c||"mouseout"===c?"mousemove":c,f=b.event;b[e]||(a.bind(e+".jCanvas",function(b){f.x=b.offsetX;f.y=b.offsetY;f.type=e;f.event=b;a.drawLayers();b.preventDefault()}),b[e]=u)}}function M(c,a,b){var e,f,j,d;b=b._args;b._event&&(c=L(c),e=c.event,a=a.isPointInPath(e.x,e.y),f=c.transforms,b.eventX=b.mouseX=e.x,b.eventY=b.mouseY=e.y,b.event=e.event,d=c.transforms.rotate,e=b.eventX,j=b.eventY,b._eventX=e*R(-d)-j*T(-d),b._eventY=j*R(-d)+e*T(-d),b._eventX/=f.scaleX,b._eventY/=
f.scaleY,!a&&(b._hovered&&!b._fired)&&(b._mousedout=u),a&&c.intersects.push(b))}function W(c,a,b,e,f){a.save();a.beginPath();a.rect(e[0],f[0],e[1]-e[0],f[1]-f[0]);a.clip();J(a,b,0);a.beginPath()}function X(c,a,b){b._event&&M(c,a,b);a.restore();N(c,a,b)}function ma(c,a){a.font?c.font=a.font:(isNaN(Number(a.fontSize))||(a.fontSize+="px"),c.font=a.fontStyle+" "+a.fontSize+" "+a.fontFamily)}function na(c,a,b,e,f){var j=/\b(\d*\.?\d*)\w\w\b/gi,g;if(G.text===e.text&&G.font===e.font&&G.fontStyle===e.fontStyle&&
G.fontSize===e.fontSize&&G.fontFamily===e.fontFamily&&G.maxWidth===e.maxWidth&&G.lineHeight===e.lineHeight)e.width=G.width,e.height=G.height;else if(!a){e.width=b.measureText(f[0]).width;for(a=1;a<f.length;a+=1)g=b.measureText(f[a]).width,g>e.width&&(e.width=g);b=c.style.fontSize;if(e.font){if(a=e.font.match(j))c.style.fontSize=e.font.match(j)[0]}else c.style.fontSize=e.fontSize;e.height=da(d.css(c,"fontSize"))*f.length*e.lineHeight;c.style.fontSize=b}}var V,ea,B=d.extend,S=Q.round,F=Q.PI,T=Q.sin,
R=Q.cos,ra=d.event.fix,aa,ba,oa,G={},P,$;d.fn.jCanvas=H;H.events={};V={align:"center",autosave:u,baseline:"middle",bringToFront:v,ccw:v,closed:v,compositing:"source-over",cornerRadius:0,cropFromCenter:u,disableDrag:v,disableEvents:v,domain:g,draggable:v,each:g,end:360,fillStyle:"transparent",font:"",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:u,fn:g,graph:"y",height:g,inDegrees:u,lineHeight:1,load:g,mask:v,maxWidth:g,method:g,miterLimit:10,opacity:1,projection:0,r1:g,r2:g,
radius:0,range:g,repeat:"repeat",rotate:0,rounded:v,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:g,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:g,sx:g,sy:g,text:"",translate:0,translateX:0,translateY:0,type:g,visible:u,width:g,x:0,y:0};H();H.extend=function(c){H.defaults=B(V,c.props);H();c.name&&(d.fn[c.name]=function b(e){var f,j,d,t=B(new E,e);for(j=0;j<this.length;j+=1)if(f=this[j],d=
C(f))e=I(f,t,e,b),K(d,t),c.fn.call(f,d,t);return this});return d.fn[c.name]};d.fn.getLayers=function(){var c=this[0];return!c||!c.getContext?[]:L(c).layers};d.fn.getLayer=function(c){var a=this.getLayers(),b=d.type(c),e,f;if(c&&c.layer)e=c;else if("number"===b)0>c&&(c=a.length+c),e=a[c];else for(f=0;f<a.length;f+=1)if(a[f].index=f,a[f].name===c||"regexp"===b&&a[f].name.match(c)){e=a[f];break}return e};d.fn.setLayer=function(c,a){var b,e;for(b=0;b<this.length;b+=1)(e=d(this[b]).getLayer(c))&&B(e,a);
return this};d.fn.moveLayer=function(c,a){var b,e,f;for(e=0;e<this.length;e+=1)if(b=d(this[e]),f=b.getLayers(),b=b.getLayer(c))f.splice(b.index,1),f.splice(a,0,b),0>a&&(a=f.length+a),b.index=a;return this};d.fn.removeLayer=function(c){var a,b,e;for(b=0;b<this.length;b+=1)a=d(this[b]),e=a.getLayers(),(a=a.getLayer(c))&&e.splice(a.index,1);return this};d.fn.removeLayers=function(){var c,a;for(c=0;c<this.length;c+=1)a=d(this[c]).getLayers(),a.length=0;return this};d.fn.getLayerGroup=function(c){var a=
this.getLayers(),b=d.type(c),e=[],f;if("array"===b)return c;for(f=0;f<a.length;f+=1)a[f].index=f,(a[f].group===c||"regexp"===b&&a[f].group.match(c))&&e.push(a[f]);return e};d.fn.setLayerGroup=function(c,a){var b,e,f;for(e=0;e<this.length;e+=1){b=d(this[e]);b=b.getLayerGroup(c);for(f=0;f<b.length;f+=1)B(b[f],a)}return this};d.fn.removeLayerGroup=function(c){var a,b,e=d.type(c),f;if(c!==w)for(b=0;b<this.length;b+=1){a=d(this[b]);a=a.getLayers();for(f=0;f<a.length;f+=1)if(a[f].index=f,a[f].group===c||
"regexp"===e&&a[f].group.match(c))a.splice(f,1),f-=1}return this};d.fn.drawLayer=function(c){var a,b,e,f;for(a=0;a<this.length;a+=1)e=d(this[a]),b=C(this[a]),f=e.getLayer(c),ia(e,b,f);return this};d.fn.drawLayers=function(){var c,a,b,e,f,j,D,t,y;for(a=0;a<this.length;a+=1)if(c=d(this[a]),b=C(this[a])){L(this[a]);c.clearCanvas();G.canvas===this[a]?D=G.data:(D=L(this[a]),G.canvas=this[a],G.data=D);e=D.layers;for(j=0;j<e.length;j+=1)f=e[j],f.index=j,f._fired=v,f._event=!f.disableEvents,ia(c,b,f),f._mousedout&&
(f._mousedout=v,f._fired=u,f._hovered=v,f.mouseout&&f.mouseout.call(this[a],f),f.cursor&&f._cursor&&c.css({cursor:f._cursor}));f=D.intersects[D.intersects.length-1]||{};b=D.event;j=b.type;f[j]||ba[j]&&(j=ba[j]);y=f[j];t=D.drag;if(f._event){if((f.mouseover||f.mouseout||f.cursor)&&!f._hovered&&!f._fired)f._fired=u,f._hovered=u,f.mouseover&&f.mouseover.call(this[a],f),f.cursor&&(f._cursor=c.css("cursor"),c.css({cursor:f.cursor}));y&&!f._fired&&(f._fired=u,y.call(this[a],f),b.type=g);if(f.draggable&&
!f.disableDrag&&("mousedown"===j||"touchstart"===j))f.bringToFront&&(e.splice(f.index,1),f.index=e.push(f)),t.layer=f,t.dragging=u,t.startX=f.x,t.startY=f.y,t.endX=f._eventX,t.endY=f._eventY,f.dragstart&&f.dragstart.call(this[a],f)}if(t.layer){if(t.dragging&&("mouseup"===j||"touchend"===j))t.layer.dragstop&&t.layer.dragstop.call(this[a],t.layer),D.drag={};if(t.dragging&&("mousemove"===j||"touchmove"===j))t.layer.x=t.layer._eventX-(t.endX-t.startX),t.layer.y=t.layer._eventY-(t.endY-t.startY),t.layer.drag&&
t.layer.drag.call(this[a],t.layer)}D.intersects=[]}return this};d.fn.addLayer=function(c){var a,b,e={};c=c||{};for(a=0;a<this.length;a+=1)if(b=C(this[a]))c.layer=e.layer=u,c.type&&!c.method&&(c.method=d.fn[oa[c.type]]),c=I(this[a],e,c,c.method);return this};P=["width","height","opacity","lineHeight"];$={};d.fn.animateLayer=function(){function c(a,b,c){return function(){ja(c);(!b.animating||b.animated===c)&&a.drawLayers();j[4]&&j[4].call(a[0],c);c._animating=v;b.animating=v;b.animated=g}}function a(a,
b,c){return function(e,f){ja(c);!c._animating&&!b.animating&&(c._animating=u,b.animating=u,b.animated=c);(!b.animating||b.animated===c)&&a.drawLayers();j[5]&&j[5].call(a[0],e,f,c)}}var b,e,f,j=[].slice.call(arguments,0),D;"object"===typeof j[0]&&!j[0].layer&&j.unshift(0);"object"===typeof j[2]?(j.splice(2,0,j[2].duration||g),j.splice(3,0,j[3].easing||g),j.splice(4,0,j[4].complete||g),j.splice(5,0,j[5].step||g)):(j[2]===w?(j.splice(2,0,g),j.splice(3,0,g),j.splice(4,0,g)):"function"===typeof j[2]&&
(j.splice(2,0,g),j.splice(3,0,g)),j[3]===w?(j[3]=g,j.splice(4,0,g)):"function"===typeof j[3]&&j.splice(3,0,g));j[1]=B({},j[1]);for(e=0;e<this.length;e+=1)if(b=d(this[e]),f=C(this[e]))if(f=L(this[e]),(D=b.getLayer(j[0]))&&D.method!==d.fn.draw)ka(D),ka(j[1],u),D.style=$,d(D).animate(j[1],{duration:j[2],easing:d.easing[j[3]]?j[3]:g,complete:c(b,f,D),step:a(b,f,D)});return this};d.fn.animateLayerGroup=function(c){var a,b,e=[].slice.call(arguments,0),f,j;for(b=0;b<this.length;b+=1){a=d(this[b]);f=a.getLayerGroup(c);
for(j=0;j<f.length;j+=1)a.animateLayer.apply(a,[f[j]].concat(e.slice(1)))}};d.fn.delayLayer=function(c,a){var b,e;a=a||0;for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),d(e).delay(a);return this};d.fn.delayLayerGroup=function(c,a){var b,e,f,j;a=a||0;for(e=0;e<this.length;e+=1){b=d(this[e]);f=b.getLayerGroup(c);for(j=0;j<f.length;j+=1)b.delayLayer.call(b,f[j],a)}};d.fn.stopLayer=function(c,a){var b,e;for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),d(e).stop(a);return this};d.fn.stopLayerGroup=
function(c,a){var b,e,f,j;for(e=0;e<this.length;e+=1){b=d(this[e]);f=b.getLayerGroup(c);for(j=0;j<f.length;j+=1)b.stopLayer.call(b,f[j],a)}};var pa="color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "),U;for(U=0;U<pa.length;U+=1)d.fx.step[pa[U]]=qa;aa={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};ba={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};O("click");
O("dblclick");O("mousedown");O("mouseup");O("mousemove");O("mouseover");O("mouseout");O("touchstart");O("touchmove");O("touchend");d.event.fix=function(c){var a,b;c=ra.call(d.event,c);if(a=c.originalEvent)if(b=a.changedTouches,c.pageX!==w&&c.offsetX===w){if(a=d(c.target).offset())c.offsetX=c.pageX-a.left,c.offsetY=c.pageY-a.top}else if(b&&(a=d(a.target).offset()))c.offsetX=b[0].pageX-a.left,c.offsetY=b[0].pageY-a.top;return c};oa={arc:"drawArc",bezier:"drawBezier",circle:"drawArc",ellipse:"drawEllipse",
"function":"draw",image:"drawImage",line:"drawLine",polygon:"drawPolygon",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector"};d.fn.draw=function a(b){var e,f;b=b||{};"function"===typeof b&&(b={fn:b});for(e=0;e<this.length;e+=1)if((f=C(this[e]))&&b.fn)b=I(this[e],{},b,a),b.fn.call(this[e],f);return this};d.fn.clearCanvas=function(a){var b,e=B(new E,a);for(a=0;a<this.length;a+=1)if(b=C(this[a]))J(b,e,e.width,e.height),b.setTransform(1,0,0,1,0,0),!e.x||!e.y||!e.width||
!e.height?b.clearRect(0,0,this[a].width,this[a].height):b.clearRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),b.restore();return this};d.fn.saveCanvas=function(){var a,b,e;for(a=0;a<this.length;a+=1)if(b=C(this[a]))e=L(this[a]),b.save(),e.savedTransforms=B({},e.transforms);return this};d.fn.restoreCanvas=function(){var a,b,e;for(a=0;a<this.length;a+=1)if(b=C(this[a]))e=L(this[a]),b.restore(),e.transforms=B({},e.savedTransforms);return this};d.fn.restoreCanvasOnRedraw=function(a){var b={layer:u,
fn:function(){d(this).restoreCanvas()}};B(b,a);return this.draw(b)};d.fn.translateCanvas=function(a){var b,e=B(new E,a),f;for(a=0;a<this.length;a+=1)if(b=C(this[a]))f=L(this[a]),e.autosave&&b.save(),ha(b,e,f.transforms);return this};d.fn.scaleCanvas=function(a){var b,e=B(new E,a),f;for(a=0;a<this.length;a+=1)if(b=C(this[a]))f=L(this[a]),e.autosave&&b.save(),ga(b,e,f.transforms);return this};d.fn.rotateCanvas=function(a){var b,e=B(new E,a),f;for(a=0;a<this.length;a+=1)if(b=C(this[a]))f=L(this[a]),
e.autosave&&b.save(),fa(b,e,f.transforms);return this};d.fn.drawRect=function b(e){var f,j,d=B(new E,e),t,g,x,z,s;for(f=0;f<this.length;f+=1)if(j=C(this[f]))e=I(this[f],d,e,b),K(j,d),J(j,d,d.width,d.height),j.beginPath(),t=d.x-d.width/2,g=d.y-d.height/2,(s=d.cornerRadius)?(d.closed=u,x=d.x+d.width/2,z=d.y+d.height/2,0>x-t-2*s&&(s=(x-t)/2),0>z-g-2*s&&(s=(z-g)/2),j.moveTo(t+s,g),j.lineTo(x-s,g),j.arc(x-s,g+s,s,3*F/2,2*F,v),j.lineTo(x,z-s),j.arc(x-s,z-s,s,0,F/2,v),j.lineTo(t+s,z),j.arc(t+s,z-s,s,F/2,
F,v),j.lineTo(t,g+s),j.arc(t+s,g+s,s,F,3*F/2,v)):j.rect(t,g,d.width,d.height),d._event&&M(this[f],j,d),N(this[f],j,d);return this};d.fn.drawArc=function e(f){var j,d,g=B(new E,f);f=f||{};!g.inDegrees&&360===g.end&&(f.end=g.end=2*F);for(j=0;j<this.length;j+=1)if(d=C(this[j]))f=I(this[j],g,f,e),K(d,g),J(d,g,2*g.radius),d.beginPath(),d.arc(g.x,g.y,g.radius,g.start*g._toRad-F/2,g.end*g._toRad-F/2,g.ccw),g._event&&M(this[j],d,g),N(this[j],d,g);return this};d.fn.drawEllipse=function f(d){var g,t,y=B(new E,
d),x=4*y.width/3,z=y.height;y.closed=u;for(g=0;g<this.length;g+=1)if(t=C(this[g]))d=I(this[g],y,d,f),K(t,y),J(t,y,y.width,y.height),t.beginPath(),t.moveTo(y.x,y.y-z/2),t.bezierCurveTo(y.x-x/2,y.y-z/2,y.x-x/2,y.y+z/2,y.x,y.y+z/2),t.bezierCurveTo(y.x+x/2,y.y+z/2,y.x+x/2,y.y-z/2,y.x,y.y-z/2),y._event&&M(this[g],t,y),N(this[g],t,y);return this};d.fn.drawPolygon=function j(d){var g,y,x=B(new E,d),z=2*F/x.sides,s=F/x.sides,n=s+F/2,p=x.radius*R(z/2),k,l,q;d.closed=x.closed=u;for(g=0;g<this.length;g+=1)if(y=
C(this[g])){d=I(this[g],x,d,j);K(y,x);J(y,x,2*x.radius);y.beginPath();for(q=0;q<x.sides;q+=1)k=x.x+S(x.radius*R(n)),l=x.y+S(x.radius*T(n)),y.lineTo(k,l),x.projection&&(k=x.x+S((p+p*x.projection)*R(n+s)),l=x.y+S((p+p*x.projection)*T(n+s)),y.lineTo(k,l)),n+=z;x._event&&M(this[g],y,x);N(this[g],y,x)}return this};d.fn.drawLine=function D(d){var g,x,z=B(new E,d),s,n,p;for(g=0;g<this.length;g+=1)if(x=C(this[g])){d=I(this[g],z,d,D);K(x,z);J(x,z,0);s=1;for(x.beginPath();u;)if(n=z["x"+s],p=z["y"+s],n!==w&&
p!==w)x.lineTo(n+z.x,p+z.y),s+=1;else break;z._event&&M(this[g],x,z);N(this[g],x,z)}return this};d.fn.drawQuadratic=d.fn.drawQuad=function t(d){var g,z,s=B(new E,d),n,p,k,l,q;for(g=0;g<this.length;g+=1)if(z=C(this[g])){d=I(this[g],s,d,t);K(z,s);J(z,s,0);n=2;z.beginPath();for(z.moveTo(s.x1+s.x,s.y1+s.y);u;)if(p=s["x"+n],k=s["y"+n],l=s["cx"+(n-1)],q=s["cy"+(n-1)],p!==w&&k!==w&&l!==w&&q!==w)z.quadraticCurveTo(l+s.x,q+s.y,p+s.x,k+s.y),n+=1;else break;s._event&&M(this[g],z,s);N(this[g],z,s)}return this};
d.fn.drawBezier=function y(g){var d,s,n=B(new E,g),p,k,l,q,r,m,h,A;for(d=0;d<this.length;d+=1)if(s=C(this[d])){g=I(this[d],n,g,y);K(s,n);J(s,n,0);p=2;k=1;s.beginPath();for(s.moveTo(n.x1+n.x,n.y1+n.y);u;)if(l=n["x"+p],q=n["y"+p],r=n["cx"+k],m=n["cy"+k],h=n["cx"+(k+1)],A=n["cy"+(k+1)],l!==w&&q!==w&&r!==w&&m!==w&&h!==w&&A!==w)s.bezierCurveTo(r+n.x,m+n.y,h+n.x,A+n.y,l+n.x,q+n.y),p+=1,k+=2;else break;n._event&&M(this[d],s,n);N(this[d],s,n)}return this};d.fn.drawVector=function x(d){var g,n,p=B(new E,d),
k,l,q,r,m;for(g=0;g<this.length;g+=1)if(n=C(this[g])){d=I(this[g],p,d,x);K(n,p);J(n,p,0);k=1;n.beginPath();r=p.x;m=p.y;for(n.moveTo(p.x,p.y);u;)if(l=p["a"+k],q=p["l"+k],l!==w&&q!==w)l=l*p._toRad-F/2,r+=q*Q.cos(l),m+=q*Q.sin(l),n.lineTo(r,m),k+=1;else break;p._event&&M(this[g],n,p);N(this[g],n,p)}return this};d.fn.drawGraph=function z(d){var n,p,k=B(new E,d),l,q,r,m,h;for(n=0;n<this.length;n+=1)if((p=C(this[n]))&&k.fn){d=I(this[n],k,d,z);K(p,k);l=k.graph;q=k.domain;r=k.range;m=this[n].width;h=this[n].height;
q===g&&(q=[g,g]);q[0]===g&&(q[0]=0);q[1]===g&&(q[1]=m);r===g&&(r=[g,g]);r[0]===g&&(r[0]=0);r[1]===g&&(r[1]=h);W(n,p,k,q,r);if("y"===l)for(l=q[0]-k.x;l<=q[1]-k.x;l+=1)h=k.fn(l),h===g?(X(this[n],p,k),W(n,p,k,q,r)):p.lineTo(l+k.x,h+k.y);else if("x"===l)for(h=r[0]-k.y;h<=r[1]-k.y;h+=1)l=k.fn(h),l===g?(X(this[n],p,k),W(n,p,k,q,r)):p.lineTo(l+k.x,h+k.y);else if("r"===l)for(m=0;m<2*F;m+=F/180)h=k.fn(m),l=h*R(m),h*=T(m),l===g||h===g?(X(this[n],p,k),W(p,k,q,r)):p.lineTo(l+k.x,h+k.y);X(this[n],p,k)}};d.fn.drawText=
function s(n){var p,k,l=B(new E,n),q,r,m,h;for(p=0;p<this.length;p+=1)if(d(this[p]),k=C(this[p])){n=I(this[p],l,n,s);K(k,l);k.textBaseline=l.baseline;k.textAlign=l.align;ma(k,l);if(!p&&l.maxWidth!==g){q=k;r=l.text;h=l.maxWidth;var A=r.split(" "),u=void 0,w=[],v="";if(q.measureText(r).width<h||1===A.length)w=[r];else{for(u=0;u<A.length;u+=1)q.measureText(v+A[u]).width>h&&(""!==v&&w.push(v),v=""),v+=A[u],u!==A.length-1&&(v+=" ");w.push(v)}q=w;q=q.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}else p||
(q=String(l.text).split("\n"));na(this[p],p,k,l,q);J(k,l,l.width,l.height);p||(m=l.x,"left"===l.align?m-=l.width/2:"right"===l.align&&(m+=l.width/2));for(r=0;r<q.length;r+=1)k.shadowColor=l.shadowColor,h=l.y+r*l.height/q.length-(q.length-1)*l.height/q.length/2,k.fillText(q[r],m,h),"transparent"!==l.fillStyle&&(k.shadowColor="transparent"),k.strokeText(q[r],m,h);l._event?(k.beginPath(),k.rect(l.x-l.width/2,l.y-l.height/2,l.width,l.height),k.restore(),M(this[p],k,l),k.closePath()):k.restore()}G=l;return this};
d.fn.measureText=function(d){var g;g=d!==w&&("object"!==typeof d||d.layer)?this.getLayer(d):B(new E,d);if((d=C(this[0]))&&g.text!==w)ma(d,g),na(this[0],0,d,g,g.text.split("\n"));return g};d.fn.drawImage=function n(d){function k(n,k,m){return function(){0===k&&(w=A.width/A.height,h.width===g&&h.sWidth===g&&(d.width=h.width=h.sWidth=A.width),h.height===g&&h.sHeight===g&&(d.height=h.height=h.sHeight=A.height),h.width===g&&h.sWidth!==g&&(h.width=h.sWidth),h.height===g&&h.sHeight!==g&&(h.height=h.sHeight),
h.sWidth===g&&h.width!==g&&(d.sWidth=h.sWidth=A.width),h.sHeight===g&&h.height!==g&&(d.sHeight=h.sHeight=A.height),h.sx===g&&(h.sx=h.cropFromCenter?A.width/2:0),h.sy===g&&(h.sy=h.cropFromCenter?A.height/2:0),h.cropFromCenter||(h.sx+=h.sWidth/2,h.sy+=h.sHeight/2),h.sx+h.sWidth/2>A.width&&(h.sx=A.width-h.sWidth/2),0>h.sx-h.sWidth/2&&(h.sx=h.sWidth/2),0>h.sy-h.sHeight/2&&(h.sy=h.sHeight/2),h.sy+h.sHeight/2>A.height&&(h.sy=A.height-h.sHeight/2),h.width!==g&&h.height===g?d.height=h.height=h.width/w:h.width===
g&&h.height!==g?d.width=h.width=h.height*w:h.width===g&&h.height===g&&(d.width=h.width=A.width,d.height=h.height=A.height));J(m,h,h.width,h.height);m.drawImage(A,h.sx-h.sWidth/2,h.sy-h.sHeight/2,h.sWidth,h.sHeight,h.x-h.width/2,h.y-h.height/2,h.width,h.height);m.fillStyle="transparent";m.beginPath();m.rect(h.x-h.width/2,h.y-h.height/2,h.width,h.height);h._event&&M(l[k],m,h);N(l[k],m,h);h.load&&h.load.call(n,d)}}var l=this,q,r,m,h=B(new E,d),A,u,w;q=h.source;u=q.getContext;q.src||u?A=q:q&&(A=new ca,
A.src=q);for(r=0;r<l.length;r+=1)if(q=l[r],m=C(l[r]))d=I(l[r],h,d,n),K(m,h),A&&(A.complete||u?k(q,r,m)():(A.onload=k(q,r,m),A.src=A.src));return l};d.fn.createPattern=d.fn.pattern=function(d){function p(){m=l.createPattern(r,q.repeat);q.load&&q.load.call(k[0],m)}var k=this,l,q=B(new E,d),r,m,h;(l=C(k[0]))?(h=q.source,"function"===typeof h?(r=Y.createElement("canvas"),r.width=q.width,r.height=q.height,d=C(r),h.call(r,d),p()):(d=h.getContext,h.src||d?r=h:(r=new ca,r.src=h),r.complete||d?p():(r.onload=
p,r.src=r.src))):m=g;return m};d.fn.createGradient=d.fn.gradient=function(d){var p;d=B(new E,d);var k=[],l,q,r,m,h,u,v;if(p=C(this[0])){d.x1=d.x1||0;d.y1=d.y1||0;d.x2=d.x2||0;d.y2=d.y2||0;p=d.r1!==g||d.r2!==g?p.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2):p.createLinearGradient(d.x1,d.y1,d.x2,d.y2);for(m=1;d["c"+m]!==w;m+=1)d["s"+m]!==w?k.push(d["s"+m]):k.push(g);l=k.length;k[0]===g&&(k[0]=0);k[l-1]===g&&(k[l-1]=1);for(m=0;m<l;m+=1){if(k[m]!==g){u=1;v=0;q=k[m];for(h=m+1;h<l;h+=1)if(k[h]!==
g){r=k[h];break}else u+=1;q>r&&(k[h]=k[m])}else k[m]===g&&(v+=1,k[m]=q+v*((r-q)/u));p.addColorStop(k[m],d["c"+(m+1)])}}else p=g;return p};d.fn.setPixels=function p(d){var g,q,r,m=B(new E,d),h={},u,w,v,F;for(q=0;q<this.length;q+=1)if(g=this[q],r=C(g)){d=I(g,m,d,p);J(r,m,m.width,m.height);if(!m.x||!m.y||!m.width||!m.height)m.width=g.width,m.height=g.height,m.x=m.width/2,m.y=m.height/2;u=r.getImageData(m.x-m.width/2,m.y-m.height/2,m.width,m.height);w=u.data;F=w.length;h=[];if(m.each)for(v=0;v<F;v+=4)h.r=
w[v],h.g=w[v+1],h.b=w[v+2],h.a=w[v+3],m.each.call(g,h),w[v]=h.r,w[v+1]=h.g,w[v+2]=h.b,w[v+3]=h.a;r.putImageData(u,m.x-m.width/2,m.y-m.height/2);r.restore()}return this};d.fn.getCanvasImage=function(d,k){var l=this[0];return l&&l.toDataURL?l.toDataURL("image/"+d,k):g};d.support.canvas=Y.createElement("canvas").getContext!==w;H.defaults=V;H.detectEvents=M;H.closePath=N;d.jCanvas=H})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
